<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Sniffmap : sniffmap: Map of probable Internet network interception" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Sniffmap</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/P1sec/sniffmap">View on GitHub</a>

          <h1 id="project_title"><a href="http://sniffmap.telcomap.org/">Sniffmap</a></h1>
          <h2 id="project_tagline"><a href="http://sniffmap.telcomap.org/">Sniffmap</a>: Map of probable Internet network interception</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/P1sec/sniffmap/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/P1sec/sniffmap/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3><a name="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"><span class="octicon octicon-link"></span></a><a href="http://sniffmap.telcomap.org/">Sniffmap</a> shows risks of interception, per country</h3>

<p><a href="http://sniffmap.telcomap.org/">Sniffmap</a> is a project to map the potential Internet mass interception performed by NSA and its allies (USA, UK, Canada, Australia, New Zealand). Since Edward Snowden disclosure, the security space has changed: rumors have been confirmed, data points have been available and new knowledge about security exposure and attack vectors is now known. This project tries to put this in easy to grasp visual representation, within the bigger context of TelcoMap.org.</p>

<a href="http://i2.cdn.turner.com/cnn/dam/assets/130606193143-02-nsa-prism-horizontal-gallery.jpg"><img src="http://i2.cdn.turner.com/cnn/dam/assets/130606193143-02-nsa-prism-horizontal-gallery.jpg"></a>

<p>Actually, we get route data not only per country but also per ISP and operator, but for now we didn't find a way to visualize that neatly. </p>

<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Results</h3>

<iframe src="http://sniffmap.telcomap.org/" width="640" height="450" scrolling="auto" frameborder="0"></iframe>

<p>Better display: <a href="http://sniffmap.telcomap.org/">http://sniffmap.telcomap.org/</a></p>

<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Research methodology</h3>

<p>As stated in the fateful NSA document, many telecommunication links go through USA and its allies to connect two other countries. This is due to least cost routing and link usage. Therefore, NSA can leverage on this to capture a lot of traffic that otherwise would not go through its points of interception.</p>

<p>To create our dataset, we try to detect each time an internet route between two IP addresses pass by an NSA controlled country and therefore can be considered as intercepted. As you'll see, around 80% of the Internet is captured by NSA and allies.</p>

<p>Our metholody is the following
<ol>
	<LI>Choose a random list of target IP address</LI>
	<LI>For each country take all known traceroute gateways</LI>
	<LI>For each traceroute gateways test each target IP address (within a pool of 255 random IP with each of the 255 class A networks)</LI>
	<LI>If this route goes through one NSA-controlled country, mark the route as "bad", otherwise the route is marked as good.</LI>
	<LI>Compute percentage over all routes for a given country (using multiple traceroute gateways hence hopefully multiple ISPs and operators to have meaningful results)</LI>
</ol>
</p>

<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Known bias</h3>

<p>There are a few known bias
<ul>
	<LI>Results are dependent on the variety of traceroute source (i.e. traceroute http gateways, looking glass, local shell access, ...).</LI>
	<LI>Results are dependent on the fact that even if traceroute sources are varied, they should be depending of different BGP AS (Autonomous Systems) in order to really represent the country's traffic.</LI>
	<LI>This analysis is not weighted by country's traffic quantity per AS, thus it is a percentage of _routes_ potentially intercepted, not of quantity of traffic intercepted.</LI>
	<LI>Not only NSA and the "Five Eyes" allies are intercepting Internet traffic. It seems to have become a popular sport these days. So you can expect also some other countries to intercept and therefore the real stats should be much higher.</LI>
	<LI>We're depending on geographic IP lookup data tables to determine location of routers. Since these cannot be 100% accurate, our stats are biased.</LI>
	<LI>On a given route, the fact that a router is attributed to one country does not clears other routers as these could also be compromised by NSA and allies or even owned by a collaborating company.</LI>
	<LI>The routes shown by traceroute may not show the underlying physical nor layer 2 network topology, such as MPLS, satellite links or fiber optic (DWDM or else) network. Therefore, this is another risk of interception and another set of location for such interceptions.</LI>
</ul>
</p>

<a name="contribute"></a>

<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Contribute!</h3>

<p>As you can see, many countries do not have measurement yet. You can help improve this by providing us traceroute results. To do this, simply run the following command (preferrably from machines located within these countries without any data yet.):</p>

<pre><code>$ curl http://sniffmap.telcomap.org/netprobe.sh | bash
</code></pre>

If you want some debug, try:
<pre><code>$ curl http://sniffmap.telcomap.org/netprobe.php?debug=1 | bash
</code></pre>

<p>This will run traceroute (or even mtr if it is installed) and report result to SniffMap.</p>

<a name="bitcoin"></a>
<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Traceroute for bitcoins</h3>

<p>Bitcoin millionaire, or just happy passionates, you can contribute to this effort: you are wealthy, and not living in one of these countries where we don't have data. But you can still help! You can donate Bitcoins (and other cryptocurrencies), this will become bounty for contributors. We will then redistribute bitcoins to the ones who contribute traceroute data. Donate any amount you wish, mountains are made of atoms.</p>

Send us bounty:
<ul>
	<LI>Bitcoin: <a href="bitcoin:132HbTVNrGWF15EVuatUgoocMFtWE1Hz1F?amount=1&message=donation+to+Bitcoin+for+traceroute">132HbTVNrGWF15EVuatUgoocMFtWE1Hz1F</a></LI>
	<LI>Anoncoin: <a href="anoncoin:AJGo5KNNKnD3E4obhB6ms3313UrAyPN6xH?amount=1&message=donation+to+Anoncoin+for+traceroute">AJGo5KNNKnD3E4obhB6ms3313UrAyPN6xH</a></LI>
	<LI>Ripple: <a href="https://ripple.com//send?to=rs3cYkNHqHhKLEvdbfhvrQMAo2CBtXxBZx&amount=300">rs3cYkNHqHhKLEvdbfhvrQMAo2CBtXxBZx</a></LI>
</ul>

<p>We will also try to rent VMs in countries we need for route diversity and SniffMap analysis.</p>

<p>Receive bounty: contribute gateways or massive traceroute submission, send us a cryptocurrency address, and we'll redistribute bounty to you! Please communicate your crypto currency address along with your contributed data (source IP or shell account, etc...)</p>

<a name="join"></a>
<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Join!</h3>

Also, have a look on Issues, if you want to help:
<a href="https://github.com/P1sec/sniffmap/issues">https://github.com/P1sec/sniffmap/issues</a>

And if you want to chat, you can just join freenode's <a href="http://webchat.freenode.net/?channels=tmplab">#tmplab</a> and ask around.

<a name="subscribe"></a>
<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Get notified</h3>

<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="http://p1sec.us4.list-manage1.com/subscribe/post?u=34c7305d04e66d0ce536f14f2&amp;id=150ed932b6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
	<label for="mce-EMAIL">Subscribe to our mailing list: get notified of new maps and releases</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_34c7305d04e66d0ce536f14f2_150ed932b6" value=""></div>
	<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
</form>
</div>
<!--End mc_embed_signup-->

<a name="people"></a>
<h3><a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>People</h3>

<p>This research has received contributions such as raw materials, inspiration and collaboration from:
<ul>
	<LI><a href="http://www.p1sec.com">P1 Security</a>'s P1 Lab project telcomap.org</LI>
	<LI><a href="http://www.tmplab.org">/tmp/lab</a> hackerspace</LI>
	<LI>Alban Crommmer from <a href="http://www.tmplab.org">/tmp/lab</a> and La Quadrature du Net; specifically for his help and his inspiring work <a href="https://nsa-observer.laquadrature.net/">NSA Observer</a></LI>
	<LI>Antoine Mazi√®re's research on networks such as <a href="http://porngram.sexualitics.org/">http://porngram.sexualitics.org/</a></LI>
	<LI><a href="http://www.tetaneutral.net/">Tetaneutral</a></LI>
	<LI>These security map research (SniffMap and others) will be presented at a workshop during <a href="http://2014.hackitoergosum.org/">Hackito Ergo Sum 2014</a> in Paris, come to this great conference and let's share a beer there.</LI>
	<LI>Marc Bruyere network support and ideas</LI>
	<LI>Renaud S. on maps</LI>
</ul>

Finally, any question about this project, you can shoot me a mail: <a href="mailto:phil+sniffmap_$((AT))_p1sec.com">phil+sniffmap $((AT)) p1sec.com</a>

</p>


      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Sniffmap maintained by <a href="https://github.com/P1sec">P1sec</a>, see <a href="http://P1sec.com/">P1sec.com</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
